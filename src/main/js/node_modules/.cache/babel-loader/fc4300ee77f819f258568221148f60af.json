{"ast":null,"code":"import _regeneratorRuntime from\"E:/\\u043F\\u0440\\u043E\\u0435\\u043A\\u0442/24.08.2021/OnlineStore/src/main/js/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/\\u043F\\u0440\\u043E\\u0435\\u043A\\u0442/24.08.2021/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"E:/\\u043F\\u0440\\u043E\\u0435\\u043A\\u0442/24.08.2021/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"E:/\\u043F\\u0440\\u043E\\u0435\\u043A\\u0442/24.08.2021/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,createContext}from'react';import'./css/Order.css';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";export var DataContext=/*#__PURE__*/createContext();export var DataProvider=function DataProvider(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),cart=_useState8[0],setCart=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),total=_useState10[0],setTotal=_useState10[1];var spinner={position:'fixed',top:'0',left:'0',right:'0',bottom:'0',margin:'auto',width:'100%',maxWidth:'300px',zIndex:'100'};// useEffect(() => {\n//   const dataCart = localStorage.getItem('cart');\n//   setCart(dataCart && dataCart.length > 0 ? JSON.parse(dataCart) : []);\n// }, [])\n// useEffect(() => {\n//   localStorage.setItem('cart', JSON.stringify(cart))\n// }, [cart])\n// useEffect(() => {\n//   const dataTotal = localStorage.getItem('total');\n//   setCart(dataTotal && dataTotal.length > 0 ? JSON.parse(dataTotal) : []);\n// }, [])\n// useEffect(() => {\n//   localStorage.setItem('total', JSON.stringify(total))\n// }, [total])\nvar addToCart=function addToCart(id){console.log(cart);var check=cart.every(function(item){return item.id!==id;});if(check){var data=products.filter(function(product){return product.id===id;});console.log(typeof id);setCart([].concat(_toConsumableArray(cart),_toConsumableArray(data)));}else{alert(\"The product has been added to cart.\");}};useEffect(function(){decrease();},[cart]);var decrease=function decrease(id){cart.forEach(function(item){if(item.id===id){item.count===1?item.count=1:item.count-=1;}});setCart(cart);getTotal();};useEffect(function(){increase();},[cart]);var increase=function increase(id){cart.forEach(function(item){if(item.id===id){item.count+=1;}});setCart(cart);getTotal();};useEffect(function(){getTotal();},[cart]);var getTotal=function getTotal(){var res=cart.reduce(function(prev,item){return prev+item.price*item.count;},0);setTotal(res);};var removeProduct=function removeProduct(id){if(window.confirm(\"Do you want to delete this product?\")){cart.forEach(function(item,index){if(item.id===id){cart.splice(index,1);}});setCart(cart);getTotal();}};useEffect(function(){getProducts(currentPage);},[currentPage]);var getProducts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(pageNumber){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/store/products?page=\".concat(pageNumber));case 3:res=_context.sent;console.log(res);setProducts(res.data);setLoading(false);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function getProducts(_x){return _ref.apply(this,arguments);};}();if(isLoading){return/*#__PURE__*/_jsx(\"img\",{src:\"https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif\",style:spinner});}var handlePageChange=function handlePageChange(e){setCurrentPage(e.target.innerText);console.log(\"page number:\",e.target);};// useEffect(() => {\n//   const getProducts = async () => {\n//     const result = await axios.get(\n//       \"https://online-store-120.herokuapp.com/store/products\"\n//     );\n//     setProducts(result.data);\n//     setLoading(false)\n//   };\n//   getProducts();\n// }, []);\n// if (isLoading) {\n//   return <div>Loading...</div>\n// }\nreturn/*#__PURE__*/_jsx(DataContext.Provider,{value:{data:products,spinner:spinner,handlePageChange:handlePageChange,currentPage:currentPage,addToCart:addToCart,cart:cart,decrease:decrease,increase:increase,total:total,getTotal:getTotal,removeProduct:removeProduct},children:props.children});};","map":{"version":3,"sources":["E:/проект/24.08.2021/OnlineStore/src/main/js/src/components/DataProvider.js"],"names":["React","useState","useEffect","createContext","axios","DataContext","DataProvider","props","products","setProducts","isLoading","setLoading","currentPage","setCurrentPage","cart","setCart","total","setTotal","spinner","position","top","left","right","bottom","margin","width","maxWidth","zIndex","addToCart","id","console","log","check","every","item","data","filter","product","alert","decrease","forEach","count","getTotal","increase","res","reduce","prev","price","removeProduct","window","confirm","index","splice","getProducts","pageNumber","get","handlePageChange","e","target","innerText","children"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createContext } from 'react';\r\nimport './css/Order.css';\r\nimport axios from 'axios';\r\n\r\nexport const DataContext = createContext()\r\n\r\nexport const DataProvider = (props) => {\r\n  const [products, setProducts] = useState([]);\r\n  const [isLoading, setLoading] = useState(true);\r\n\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n\r\n  const [cart, setCart] = useState([]);\r\n  const [total, setTotal] = useState(0);\r\n\r\n  const spinner = {\r\n    position: 'fixed',\r\n    top: '0',\r\n    left: '0',\r\n    right: '0',\r\n    bottom: '0',\r\n    margin: 'auto',\r\n    width: '100%',\r\n    maxWidth: '300px',\r\n    zIndex: '100'\r\n  }\r\n\r\n\r\n  // useEffect(() => {\r\n  //   const dataCart = localStorage.getItem('cart');\r\n  //   setCart(dataCart && dataCart.length > 0 ? JSON.parse(dataCart) : []);\r\n  // }, [])\r\n\r\n  // useEffect(() => {\r\n  //   localStorage.setItem('cart', JSON.stringify(cart))\r\n  // }, [cart])\r\n\r\n  // useEffect(() => {\r\n  //   const dataTotal = localStorage.getItem('total');\r\n  //   setCart(dataTotal && dataTotal.length > 0 ? JSON.parse(dataTotal) : []);\r\n  // }, [])\r\n\r\n  // useEffect(() => {\r\n  //   localStorage.setItem('total', JSON.stringify(total))\r\n  // }, [total])\r\n\r\n  const addToCart = (id) => {\r\n    console.log(cart)\r\n    const check = cart.every(item => {\r\n      return item.id !== id\r\n    })\r\n    if (check) {\r\n      const data = products.filter(product => {\r\n        return product.id === id\r\n      })\r\n      console.log(typeof id)\r\n      setCart([...cart, ...data])\r\n    } else {\r\n      alert(\"The product has been added to cart.\")\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    decrease();\r\n  }, [cart])\r\n\r\n  const decrease = id => {\r\n    cart.forEach(item => {\r\n      if (item.id === id) {\r\n        item.count === 1 ? item.count = 1 : item.count -= 1;\r\n      }\r\n    })\r\n    setCart(cart);\r\n    getTotal();\r\n  }\r\n\r\n\r\n  useEffect(() => {\r\n    increase();\r\n  }, [cart])\r\n\r\n  const increase = id => {\r\n    cart.forEach(item => {\r\n      if (item.id === id) {\r\n        item.count += 1;\r\n      }\r\n    })\r\n    setCart(cart);\r\n    getTotal();\r\n  }\r\n\r\n  useEffect(() => {\r\n    getTotal();\r\n  }, [cart])\r\n\r\n  const getTotal = () => {\r\n    const res = cart.reduce((prev, item) => {\r\n      return prev + (item.price * item.count);\r\n    }, 0)\r\n    setTotal(res)\r\n  }\r\n\r\n  const removeProduct = id => {\r\n    if (window.confirm(\"Do you want to delete this product?\")) {\r\n      cart.forEach((item, index) => {\r\n        if (item.id === id) {\r\n          cart.splice(index, 1)\r\n        }\r\n      })\r\n      setCart(cart);\r\n      getTotal();\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    getProducts(currentPage);\r\n  }, [currentPage]);\r\n\r\n  const getProducts = async (pageNumber) => {\r\n    try {\r\n      const res = await axios.get(\r\n        `/store/products?page=${pageNumber}`\r\n      );\r\n      console.log(res);\r\n      setProducts(res.data);\r\n      setLoading(false)\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <img src=\"https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif\" style={spinner} />\r\n  }\r\n\r\nconst handlePageChange = (e) => {\r\n  setCurrentPage(e.target.innerText);\r\n  console.log(\"page number:\", e.target);\r\n};\r\n\r\n\r\n  // useEffect(() => {\r\n  //   const getProducts = async () => {\r\n  //     const result = await axios.get(\r\n  //       \"https://online-store-120.herokuapp.com/store/products\"\r\n  //     );\r\n  //     setProducts(result.data);\r\n  //     setLoading(false)\r\n  //   };\r\n  //   getProducts();\r\n  // }, []);\r\n\r\n  // if (isLoading) {\r\n  //   return <div>Loading...</div>\r\n  // }\r\n\r\n\r\n\r\n  return (\r\n    <DataContext.Provider value={{ data: products, spinner, handlePageChange, currentPage, addToCart, cart, decrease, increase, total, getTotal, removeProduct }}>\r\n      {props.children}\r\n    </DataContext.Provider>\r\n  );\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}