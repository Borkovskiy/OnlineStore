{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{createContext}from'react';import{useHistory}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";export var UserContext=/*#__PURE__*/createContext();export var UserProvider=function UserProvider(props){var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){return setShow(true);};var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),forgotEmail=_useState4[0],setForgotEmail=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),email=_useState6[0],setEmail=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),currentEmail=_useState10[0],setCurrentEmail=_useState10[1];var _useState11=useState(undefined),_useState12=_slicedToArray(_useState11,2),status=_useState12[0],setStatus=_useState12[1];var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();data={email:email,password:password};_context.next=4;return fetch('https://online-store-120.herokuapp.com/login',{method:'POST',headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)}).then(function(){console.log('user-info: ',data);localStorage.setItem('user-info: ',JSON.stringify(data));});case 4:_context.next=6;return getCurrentUser();case 6:history.push(\"/user\");case 7:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var handleLogout=function handleLogout(){setCurrentEmail(\"\");};var getCurrentUser=function getCurrentUser(){return fetch('user_info').then(function(res){return res.json();}).then(function(res){setCurrentEmail(res.email);});};useEffect(function(){getCurrentUser();},[]);var forgotSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var data,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();data={forgotEmail:forgotEmail};_context2.prev=2;_context2.next=5;return fetch(\"https://online-store-120.herokuapp.com/forgot_password\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)}).then(function(response){if(response.status==200){return response.json();}else{throw Error(response.statusText);}});case 5:result=_context2.sent;console.log(\"success scope\");setStatus({type:\"success\"});_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](2);console.log(\"error scope\");setStatus({type:\"error\",error:_context2.t0});case 14:_context2.prev=14;setTimeout(handleClose,3000);return _context2.finish(14);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[2,10,14,17]]);}));return function forgotSubmit(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(UserContext.Provider,{value:{email:email,currentEmail:currentEmail,handleLogout:handleLogout,handleSubmit:handleSubmit,setEmail:setEmail,setPassword:setPassword,show:show,handleClose:handleClose,forgotSubmit:forgotSubmit,setForgotEmail:setForgotEmail,handleShow:handleShow,status:status},children:props.children});};","map":{"version":3,"sources":["/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/src/components/section/Registration/UserProvider.js"],"names":["React","useState","useEffect","createContext","useHistory","UserContext","UserProvider","props","history","show","setShow","handleClose","handleShow","forgotEmail","setForgotEmail","email","setEmail","password","setPassword","currentEmail","setCurrentEmail","undefined","status","setStatus","handleSubmit","e","preventDefault","data","fetch","method","headers","body","JSON","stringify","then","console","log","localStorage","setItem","getCurrentUser","push","handleLogout","res","json","forgotSubmit","response","Error","statusText","result","type","error","setTimeout","children"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { createContext } from 'react'\nimport { useHistory } from 'react-router-dom'\n\nexport const UserContext = createContext()\n\nexport const UserProvider = (props) => {\n    let history = useHistory()\n\n    const [show, setShow] = useState(false);\n\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n\n    const [forgotEmail, setForgotEmail] = useState(\"\")\n\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\")\n\n    const [currentEmail, setCurrentEmail] = useState(\"\")\n\n    const [status, setStatus] = useState(undefined)\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        const data = { email, password };\n\n        await fetch('https://online-store-120.herokuapp.com/login', {\n            method: 'POST',\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify(data)\n        }).then(() => {\n            console.log('user-info: ', data)\n            localStorage.setItem('user-info: ', JSON.stringify(data))\n        });\n\n        await getCurrentUser();\n\n        history.push(\"/user\")\n    }\n\n    const handleLogout = () => {\n        setCurrentEmail(\"\")\n    }\n\n    const getCurrentUser = () =>\n        fetch('user_info')\n            .then((res) =>\n                res.json()\n            )\n            .then((res) => {\n                setCurrentEmail(res.email);\n            })\n\n    useEffect(() => {\n        getCurrentUser()\n    }, [])\n\n    const forgotSubmit = async (e) => {\n        e.preventDefault();\n        const data = { forgotEmail };\n        try {\n            const result = await fetch(\"https://online-store-120.herokuapp.com/forgot_password\", {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify(data)\n            }).then((response) => {\n                if (response.status == 200) {\n                    return response.json();\n                } else {\n                    throw Error(response.statusText);\n                }\n            });\n            console.log(\"success scope\");\n            setStatus({ type: \"success\" });\n        } catch (error) {\n            console.log(\"error scope\");\n            setStatus({ type: \"error\", error });\n        } finally {\n            setTimeout(handleClose, 3000);\n        }\n    };\n\n    return (\n        <UserContext.Provider value={{ email, currentEmail, handleLogout, handleSubmit, setEmail, setPassword, show, handleClose, forgotSubmit, setForgotEmail, handleShow, status }}>\n            {props.children}\n        </UserContext.Provider>\n    );\n}"]},"metadata":{},"sourceType":"module"}