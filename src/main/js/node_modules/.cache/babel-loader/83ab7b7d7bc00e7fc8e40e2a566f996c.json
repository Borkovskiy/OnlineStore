{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{createContext}from'react';import{useHistory}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";export var UserContext=/*#__PURE__*/createContext();export var UserProvider=function UserProvider(props){var history=useHistory();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),currentEmail=_useState6[0],setCurrentEmail=_useState6[1];var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();data={email:email,password:password};_context.next=4;return fetch('https://online-store-120.herokuapp.com/login',{method:'POST',headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)}).then(function(){console.log('user-info: ',data);localStorage.setItem('user-info: ',JSON.stringify(data));// if (response.status === 200) {\n//     return history.push(\"/user\")\n// } else {\n//     console.log(response)\n// }\n});case 4:_context.next=6;return getCurrentUser();case 6:history.push(\"/user\");case 7:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var getCurrentUser=function getCurrentUser(){return fetch('https://online-store-120.herokuapp.com/user').then(function(res){return res.json();}).then(function(res){return console.log(res);});};useEffect(function(){getCurrentUser().then(function(currentEmail){return setCurrentEmail(currentEmail);});},[]);return/*#__PURE__*/_jsx(UserContext.Provider,{value:{email:email,currentEmail:currentEmail,handleSubmit:handleSubmit,setEmail:setEmail,setPassword:setPassword},children:props.children});};","map":{"version":3,"sources":["/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/src/components/section/Registration/UserProvider.js"],"names":["React","useState","useEffect","createContext","useHistory","UserContext","UserProvider","props","history","email","setEmail","password","setPassword","currentEmail","setCurrentEmail","handleSubmit","e","preventDefault","data","fetch","method","headers","body","JSON","stringify","then","console","log","localStorage","setItem","getCurrentUser","push","res","json","children"],"mappings":"+bAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,aAAT,KAA8B,OAA9B,CACA,OAASC,UAAT,KAA2B,kBAA3B,C,2CAEA,MAAO,IAAMC,CAAAA,WAAW,cAAGF,aAAa,EAAjC,CAEP,MAAO,IAAMG,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,KAAD,CAAW,CAEnC,GAAIC,CAAAA,OAAO,CAAGJ,UAAU,EAAxB,CAEA,cAA0BH,QAAQ,CAAC,EAAD,CAAlC,wCAAOQ,KAAP,eAAcC,QAAd,eACA,eAAgCT,QAAQ,CAAC,EAAD,CAAxC,yCAAOU,QAAP,eAAiBC,WAAjB,eAEA,eAAwCX,QAAQ,CAAC,EAAD,CAAhD,yCAAOY,YAAP,eAAqBC,eAArB,eAEA,GAAMC,CAAAA,YAAY,0FAAG,iBAAOC,CAAP,2HACjBA,CAAC,CAACC,cAAF,GACMC,IAFW,CAEJ,CAAET,KAAK,CAALA,KAAF,CAASE,QAAQ,CAARA,QAAT,CAFI,uBAIXQ,CAAAA,KAAK,CAAC,8CAAD,CAAiD,CACxDC,MAAM,CAAE,MADgD,CAExDC,OAAO,CAAE,CAAE,eAAgB,kBAAlB,CAF+C,CAGxDC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeN,IAAf,CAHkD,CAAjD,CAAL,CAIHO,IAJG,CAIE,UAAM,CACVC,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BT,IAA3B,EACAU,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAoCN,IAAI,CAACC,SAAL,CAAeN,IAAf,CAApC,EAEA;AACA;AACA;AACA;AACA;AACH,CAbK,CAJW,8BAmBXY,CAAAA,cAAc,EAnBH,QAqBjBtB,OAAO,CAACuB,IAAR,CAAa,OAAb,EArBiB,sDAAH,kBAAZhB,CAAAA,YAAY,4CAAlB,CAwBA,GAAMe,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,SACnBX,CAAAA,KAAK,CAAC,6CAAD,CAAL,CACKM,IADL,CACU,SAACO,GAAD,QACFA,CAAAA,GAAG,CAACC,IAAJ,EADE,EADV,EAIHR,IAJG,CAIE,SAACO,GAAD,QAAQN,CAAAA,OAAO,CAACC,GAAR,CAAYK,GAAZ,CAAR,EAJF,CADmB,EAAvB,CAOA9B,SAAS,CAAC,UAAM,CACZ4B,cAAc,GAAGL,IAAjB,CAAsB,SAACZ,YAAD,QAAkBC,CAAAA,eAAe,CAACD,YAAD,CAAjC,EAAtB,EACH,CAFQ,CAEN,EAFM,CAAT,CAIA,mBACI,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAAEJ,KAAK,CAALA,KAAF,CAASI,YAAY,CAAZA,YAAT,CAAuBE,YAAY,CAAZA,YAAvB,CAAqCL,QAAQ,CAARA,QAArC,CAA+CE,WAAW,CAAXA,WAA/C,CAA7B,UACKL,KAAK,CAAC2B,QADX,EADJ,CAKH,CAjDM","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { createContext } from 'react'\nimport { useHistory } from 'react-router-dom'\n\nexport const UserContext = createContext()\n\nexport const UserProvider = (props) => {\n\n    let history = useHistory()\n\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\")\n\n    const [currentEmail, setCurrentEmail] = useState(\"\")\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        const data = { email, password };\n\n        await fetch('https://online-store-120.herokuapp.com/login', {\n            method: 'POST',\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify(data)\n        }).then(() => {\n            console.log('user-info: ', data)\n            localStorage.setItem('user-info: ', JSON.stringify(data))\n           \n            // if (response.status === 200) {\n            //     return history.push(\"/user\")\n            // } else {\n            //     console.log(response)\n            // }\n        });\n\n        await getCurrentUser();\n\n        history.push(\"/user\")\n    }\n\n    const getCurrentUser = () =>\n        fetch('https://online-store-120.herokuapp.com/user')\n            .then((res) =>\n                res.json()\n            )\n    .then((res) =>console.log(res))\n\n    useEffect(() => {\n        getCurrentUser().then((currentEmail) => setCurrentEmail(currentEmail));\n    }, [])\n\n    return (\n        <UserContext.Provider value={{ email, currentEmail, handleSubmit, setEmail, setPassword }}>\n            {props.children}\n        </UserContext.Provider>\n    );\n}"]},"metadata":{},"sourceType":"module"}