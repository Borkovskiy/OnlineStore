{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,createContext}from'react';import'./css/Order.css';import axios from'axios';import Backdrop from'@material-ui/core/Backdrop';import CircularProgress from'@material-ui/core/CircularProgress';import{makeStyles}from'@material-ui/core/styles';import{jsx as _jsx}from\"react/jsx-runtime\";export var DataContext=/*#__PURE__*/createContext();export var DataProvider=function DataProvider(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),cart=_useState8[0],setCart=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),total=_useState10[0],setTotal=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),show=_useState12[0],setShow=_useState12[1];var useStyles=makeStyles(function(theme){return{backdrop:{zIndex:theme.zIndex.drawer+1,color:'#fff'}};});var classes=useStyles();var addToCart=function addToCart(id){var _console;(_console=console).log.apply(_console,_toConsumableArray(cart));var check=cart.every(function(item){return item.id!==id;});if(check){var data=products.filter(function(product){return product.id===id;});console.log(typeof id);setCart([].concat(_toConsumableArray(cart),_toConsumableArray(data)));}};var productIdCount={products:cart.reduce(function(acc,val){acc[val.id]=val.count;return acc;},{})};var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){return setShow(true);};setTimeout(function(){handleClose();},3000);useEffect(function(){decrease();},[cart]);var decrease=function decrease(id){cart.forEach(function(item){if(item.id===id){item.count===1?item.count=1:item.count-=1;}});setCart(cart);getTotal();};useEffect(function(){increase();},[cart]);var increase=function increase(id){cart.forEach(function(item){if(item.id===id){item.count+=1;}});setCart(cart);getTotal();};useEffect(function(){getTotal();},[cart]);var getTotal=function getTotal(){var res=cart.reduce(function(prev,item){return prev+item.price*item.count;},0);setTotal(res);};var removeProduct=function removeProduct(id){if(window.confirm(\"Do you want to delete this product?\")){cart.forEach(function(item,index){if(item.id===id){cart.splice(index,1);}});setCart(cart);localStorage.setItem('cart: ',cart);getTotal();}};useEffect(function(){getProducts(currentPage);},[currentPage]);var getProducts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(pageNumber){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"https://online-store-120.herokuapp.com/store/products?page=\".concat(pageNumber));case 3:res=_context.sent;console.log(res);setProducts(res.data);localStorage.setItem('user-info: ',res.data);setLoading(false);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function getProducts(_x){return _ref.apply(this,arguments);};}();if(isLoading){return/*#__PURE__*/_jsx(Backdrop,{className:classes.backdrop,open:true,children:/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\"})});}var handlePageChange=function handlePageChange(e){setCurrentPage(e.target.innerText);console.log(\"page number:\",e.target);};return/*#__PURE__*/_jsx(DataContext.Provider,{value:{data:products,handleShow:handleShow,show:show,handleClose:handleClose,handlePageChange:handlePageChange,currentPage:currentPage,addToCart:addToCart,cart:cart,decrease:decrease,increase:increase,total:total,getTotal:getTotal,removeProduct:removeProduct,productIdCount:productIdCount},children:props.children});};","map":{"version":3,"sources":["/Users/macuser/Desktop/Project Online-store/OnlineStore/src/main/js/src/components/DataProvider.js"],"names":["React","useState","useEffect","createContext","axios","Backdrop","CircularProgress","makeStyles","DataContext","DataProvider","props","products","setProducts","isLoading","setLoading","currentPage","setCurrentPage","cart","setCart","total","setTotal","show","setShow","useStyles","theme","backdrop","zIndex","drawer","color","classes","addToCart","id","console","log","check","every","item","data","filter","product","productIdCount","reduce","acc","val","count","handleClose","handleShow","setTimeout","decrease","forEach","getTotal","increase","res","prev","price","removeProduct","window","confirm","index","splice","localStorage","setItem","getProducts","pageNumber","get","handlePageChange","e","target","innerText","children"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createContext } from 'react';\nimport './css/Order.css';\nimport axios from 'axios';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\n\nexport const DataContext = createContext()\n\nexport const DataProvider = (props) => {\n  const [products, setProducts] = useState([]);\n  const [isLoading, setLoading] = useState(true);\n\n  const [currentPage, setCurrentPage] = useState(1);\n\n  const [cart, setCart] = useState([]);\n  const [total, setTotal] = useState(0);\n\n  const [show, setShow] = useState(false);\n\n  const useStyles = makeStyles((theme) => ({\n    backdrop: {\n      zIndex: theme.zIndex.drawer + 1,\n      color: '#fff',\n    },\n  }));\n\n  const classes = useStyles()\n\n  const addToCart = (id) => {\n    console.log(...cart)\n    const check = cart.every(item => {\n      return item.id !== id\n    })\n    if (check) {\n      const data = products.filter(product => {\n        return product.id === id\n      })\n      console.log(typeof id)\n      setCart([...cart, ...data])\n    }\n  };\n\n  const productIdCount = {\n    products: cart.reduce((acc, val) => {\n        acc[val.id] = val.count;\n        return acc;\n    }, {})\n}\n\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n\n  setTimeout(() => {\n    handleClose()\n}, 3000);\n\n  useEffect(() => {\n    decrease();\n  }, [cart])\n\n  const decrease = id => {\n    cart.forEach(item => {\n      if (item.id === id) {\n        item.count === 1 ? item.count = 1 : item.count -= 1;\n      }\n    })\n    setCart(cart);\n    getTotal();\n  }\n\n\n  useEffect(() => {\n    increase();\n  }, [cart])\n\n  const increase = id => {\n    cart.forEach(item => {\n      if (item.id === id) {\n        item.count += 1;\n      }\n    })\n    setCart(cart);\n    getTotal();\n  }\n\n  useEffect(() => {\n    getTotal();\n  }, [cart])\n\n  const getTotal = () => {\n    const res = cart.reduce((prev, item) => {\n      return prev + (item.price * item.count);\n    }, 0)\n    setTotal(res)\n  }\n\n  const removeProduct = id => {\n    if (window.confirm(\"Do you want to delete this product?\")) {\n      cart.forEach((item, index) => {\n        if (item.id === id) {\n          cart.splice(index, 1)\n        }\n      })\n      setCart(cart);\n      localStorage.setItem('cart: ', cart)\n      getTotal();\n    }\n  }\n\n  useEffect(() => {\n    getProducts(currentPage);\n  }, [currentPage]);\n\n  const getProducts = async (pageNumber) => {\n    try {\n      const res = await axios.get(\n        `https://online-store-120.herokuapp.com/store/products?page=${pageNumber}`\n      );\n      console.log(res);\n      setProducts(res.data);\n      localStorage.setItem('user-info: ', res.data)\n      setLoading(false)\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  if (isLoading) {\n    return <Backdrop className={classes.backdrop} open>\n      <CircularProgress color=\"inherit\" />\n    </Backdrop>\n  }\n\n  const handlePageChange = (e) => {\n    setCurrentPage(e.target.innerText);\n    console.log(\"page number:\", e.target);\n  };\n\n  return (\n    <DataContext.Provider value={{ data: products, handleShow, show, handleClose, handlePageChange, currentPage, addToCart, cart, decrease, increase, total, getTotal, removeProduct, productIdCount }}>\n      {props.children}\n    </DataContext.Provider>\n  );\n}\n\n"]},"metadata":{},"sourceType":"module"}